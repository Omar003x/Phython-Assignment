import json

# User base class
class User:
    def __init__(self, email, username, password, role):
        self.email = email
        self.username = username
        self.password = password
        self.role = role

    def update_profile(self):
        print("\nUpdate Profile")
        print("1. Email")
        print("2. Password")
        choice = input("Enter your choice: ")

        if choice == "1":
            self.email = input("Enter new email: ")
            print("Email updated successfully.")
        elif choice == "2":
            self.password = input("Enter new password: ")
            print("Password updated successfully.")
        else:
            print("Invalid choice. Please try again.")

# Derived classes for each user role
class Trainer(User):
    def __init__(self, email, username, password):
        super().__init__(email, username, password, "trainer")

    # Add Trainer-specific functionalities here

class Lecturer(User):
    def __init__(self, email, username, password):
        super().__init__(email, username, password, "lecturer")

    # Add Lecturer-specific functionalities here

class Admin(User):
    def __init__(self, email, username, password):
        super().__init__(email, username, password, "admin")

    def manage_courses(self, courses):
        print("\nCourse Management")
        print("1. Add Course")
        print("2. Remove Course")
        choice = input("Enter your choice: ")

        if choice == "1":
            course_name = input("Enter the course name: ")
            courses.append(course_name)
            print(f"Course '{course_name}' added successfully.")
        elif choice == "2":
            course_name = input("Enter the course name to remove: ")
            if course_name in courses:
                courses.remove(course_name)
                print(f"Course '{course_name}' removed successfully.")
            else:
                print("Course not found.")

    def manage_users(self, users):
        print("\nUser Management")
        print("1. List Users")
        print("2. Delete User")
        choice = input("Enter your choice: ")

        if choice == "1":
            for user in users:
                print(f"Username: {user['username']}, Role: {user['role']}")
        elif choice == "2":
            username_to_delete = input("Enter the username of the user to delete: ")
            users[:] = [user for user in users if user['username'] != username_to_delete]
            print(f"User '{username_to_delete}' deleted successfully.")

# Functions for loading and saving user data
def load_users(filename='users.json'):
    try:
        with open(filename, 'r') as f:
            return json.load(f)
    except FileNotFoundError:
        return []

def save_users(users, filename='users.json'):
    with open(filename, 'w') as f:
        json.dump(users, f, indent=4)

# Function for user login
def login(users):
    username = input("Enter username: ")
    password = input("Enter password: ")
    for user in users:
        if user['username'] == username and user['password'] == password:
            print(f"Welcome back, {username}!")
            return user
    print("Invalid username or password.")
    return None

# Function for registering a new user
def register_user(users):
    email = input("Enter your email: ")
    username = input("Enter your username: ")
    password = input("Enter your password: ")
    role = input("Enter your role (admin/lecturer/trainer/student): ")

    new_user = {'email': email, 'username': username, 'password': password, 'role': role}
    users.append(new_user)
    save_users(users)
    print(f"User {username} registered successfully.")

# Main function to run the application
def main():
    users = load_users()
    courses = []  # Placeholder for courses list

    while True:
        print("\nWelcome to the User Management System")
        print("1. Login")
        print("2. Register")
        print("3. Exit")
        choice = input("Enter your choice: ")

        if choice == "1":
            user = login(users)
            if user:
                if user['role'] == 'admin':
                    admin = Admin(user['email'], user['username'], user['password'])
                    while True:
                        print("\nAdmin Menu")
                        print("1. Update Profile")
                        print("2. Manage Courses")
                        print("3. Manage Users")
                        print("4. Delete Users")
